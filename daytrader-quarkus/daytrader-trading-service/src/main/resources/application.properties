# Application Configuration
quarkus.application.name=daytrader-trading-service
quarkus.http.port=8081

# Database Configuration
quarkus.datasource.db-kind=postgresql
# Dev mode - uses Dev Services (Testcontainers) for PostgreSQL
%dev.quarkus.datasource.devservices.enabled=true
%dev.quarkus.datasource.devservices.image-name=postgres:16-alpine
%dev.quarkus.datasource.devservices.db-name=daytrader_trading
# Production configuration
%prod.quarkus.datasource.username=daytrader
%prod.quarkus.datasource.password=daytrader
%prod.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/daytrader_trading

# Hibernate Configuration
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.sql-load-script=no-file

# Flyway Configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=1.0.0

# OpenAPI Configuration
quarkus.smallrye-openapi.path=/openapi
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/swagger-ui

# JWT Configuration (Simple JWT - No OIDC/Keycloak)
mp.jwt.verify.issuer=https://daytrader.example.com
smallrye.jwt.verify.key.location=publicKey.pem
mp.jwt.verify.audiences=daytrader-api

# ===========================================
# Messaging Configuration (In-Memory by default)
# ===========================================
# Internal channels: When producer (@Channel Emitter) and consumer (@Incoming)
# use the SAME channel name and no connector is configured, SmallRye Reactive
# Messaging wires them together internally. No external broker needed.
# See ADR-002 for rationale and future Kafka migration path.
#
# orders-out: Used by both OrderEventProducer (Emitter) and OrderEventConsumer (@Incoming)

# ===========================================
# Kafka Configuration (activate with -Dquarkus.profile=kafka)
# ===========================================
# To enable Kafka:
# 1. Add quarkus-messaging-kafka dependency
# 2. Run with: mvn quarkus:dev -Dquarkus.profile=kafka
#
# %kafka.kafka.bootstrap.servers=localhost:19092
# %kafka.mp.messaging.outgoing.orders-out.connector=smallrye-kafka
# %kafka.mp.messaging.outgoing.orders-out.topic=orders
# %kafka.mp.messaging.outgoing.orders-out.value.serializer=io.quarkus.kafka.client.serialization.ObjectMapperSerializer
# %kafka.mp.messaging.incoming.orders-in.connector=smallrye-kafka
# %kafka.mp.messaging.incoming.orders-in.topic=orders
# %kafka.mp.messaging.incoming.orders-in.value.deserializer=io.quarkus.kafka.client.serialization.ObjectMapperDeserializer
# %kafka.mp.messaging.incoming.orders-in.auto.offset.reset=earliest

# Observability - Metrics
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/metrics

# Observability - Tracing
quarkus.otel.exporter.otlp.traces.endpoint=http://localhost:4317

# Health Checks
quarkus.smallrye-health.root-path=/health

# Logging
quarkus.log.level=INFO
quarkus.log.category."com.daytrader".level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# ===========================================
# REST Client Configuration (Account Service)
# ===========================================
quarkus.rest-client.account-service.url=${ACCOUNT_SERVICE_URL:http://localhost:8080}
quarkus.rest-client.account-service.scope=jakarta.inject.Singleton

# ===========================================
# REST Client Configuration (Market Service)
# ===========================================
quarkus.rest-client.market-service.url=${MARKET_SERVICE_URL:http://localhost:8082}
quarkus.rest-client.market-service.scope=jakarta.inject.Singleton

# ===========================================
# CORS Configuration
# ===========================================
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ORIGINS:http://localhost:3000,http://localhost:3001}
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.exposed-headers=location,info
quarkus.http.cors.access-control-max-age=24H
quarkus.http.cors.access-control-allow-credentials=true

