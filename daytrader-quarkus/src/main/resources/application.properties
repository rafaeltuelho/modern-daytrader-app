# =============================================================================
# DayTrader Quarkus Application Configuration
# =============================================================================

# Application name
quarkus.application.name=daytrader-quarkus

# -----------------------------------------------------------------------------
# Database Configuration - Dev Services (auto-starts PostgreSQL in dev mode)
# -----------------------------------------------------------------------------
%dev.quarkus.datasource.devservices.enabled=true
%dev.quarkus.datasource.devservices.image-name=postgres:16-alpine
%dev.quarkus.datasource.devservices.port=5432
%dev.quarkus.datasource.devservices.db-name=daytraderdb
%dev.quarkus.datasource.devservices.username=daytrader
%dev.quarkus.datasource.devservices.password=daytrader

# Production database configuration (placeholder - override in production)
%prod.quarkus.datasource.db-kind=postgresql
%prod.quarkus.datasource.username=${DB_USER:daytrader}
%prod.quarkus.datasource.password=${DB_PASSWORD:daytrader}
%prod.quarkus.datasource.jdbc.url=${DB_URL:jdbc:postgresql://localhost:5432/daytraderdb}

# Hibernate ORM configuration
# In dev mode, Flyway handles schema; Hibernate validates
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true
%prod.quarkus.hibernate-orm.log.sql=false

# -----------------------------------------------------------------------------
# Flyway Configuration - Database Migrations
# -----------------------------------------------------------------------------
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.locations=db/migration

# Clean database before migration (dev/test only - NEVER in production!)
%dev.quarkus.flyway.clean-at-start=true
%test.quarkus.flyway.clean-at-start=true
%prod.quarkus.flyway.clean-at-start=false

# -----------------------------------------------------------------------------
# CORS Configuration - Allow frontend origin for cross-origin requests
# -----------------------------------------------------------------------------
quarkus.http.cors=true
# Dev mode: allow Vite dev server
%dev.quarkus.http.cors.origins=http://localhost:5173,http://localhost:3000
# Test mode: allow test origins
%test.quarkus.http.cors.origins=http://localhost:5173,http://localhost:3000
# Production: configure via environment variable
%prod.quarkus.http.cors.origins=${CORS_ORIGINS:http://localhost:5173}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=location,info
quarkus.http.cors.access-control-max-age=24H
quarkus.http.cors.access-control-allow-credentials=true

# -----------------------------------------------------------------------------
# JWT Configuration - Secure API endpoints with JWT tokens
# -----------------------------------------------------------------------------
# Enable JWT authentication
smallrye.jwt.enabled=true

# JWT issuer and audience
mp.jwt.verify.issuer=${JWT_ISSUER:https://daytrader.example.com}
mp.jwt.verify.audiences=${JWT_AUDIENCE:daytrader-api}

# Public key for JWT verification (all environments)
mp.jwt.verify.publickey.location=publicKey.pem

# Private key for JWT signing (for token generation)
smallrye.jwt.sign.key.location=privateKey.pem

# Token expiration (in seconds) - default 1 hour
daytrader.jwt.token.expiration=3600

# Token clock skew allowance (in seconds)
mp.jwt.verify.clock.skew=60

# -----------------------------------------------------------------------------
# OpenAPI / Swagger UI Configuration
# -----------------------------------------------------------------------------
quarkus.swagger-ui.always-include=true
%prod.quarkus.swagger-ui.always-include=false
quarkus.swagger-ui.path=/swagger-ui
quarkus.swagger-ui.theme=material

# OpenAPI metadata
quarkus.smallrye-openapi.info-title=DayTrader API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.info-description=DayTrader modernized REST API - a stock trading benchmark application
quarkus.smallrye-openapi.info-contact-name=DayTrader Team
quarkus.smallrye-openapi.info-license-name=Apache 2.0
quarkus.smallrye-openapi.info-license-url=https://www.apache.org/licenses/LICENSE-2.0.html

# OpenAPI path
quarkus.smallrye-openapi.path=/openapi

# -----------------------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------------------
quarkus.health.extensions.enabled=true
quarkus.smallrye-health.ui.enable=true
%prod.quarkus.smallrye-health.ui.enable=false

# -----------------------------------------------------------------------------
# HTTP Server Configuration
# -----------------------------------------------------------------------------
quarkus.http.port=8080
%dev.quarkus.http.port=8080
%test.quarkus.http.port=8081

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
quarkus.log.level=INFO
%dev.quarkus.log.level=INFO
quarkus.log.category."com.ibm.websphere.samples.daytrader".level=DEBUG
%prod.quarkus.log.category."com.ibm.websphere.samples.daytrader".level=INFO

# Console logging format
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
